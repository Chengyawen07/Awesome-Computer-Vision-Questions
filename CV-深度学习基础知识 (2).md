# CV-æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯† (2)



## ğŸš€ **6. CNN å…¸å‹å±‚æ¬¡ï¼ˆLayerï¼‰åŠå…¶ä½œç”¨**

å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNN, Convolutional Neural Networkï¼‰ä¸»è¦ç”¨äº**å›¾åƒå¤„ç†**ä»»åŠ¡ï¼Œå®ƒçš„ç»“æ„ç”±å¤šä¸ª**ä¸åŒçš„å±‚ï¼ˆLayerï¼‰**ç»„æˆï¼Œæ¯ä¸€å±‚æœ‰ä¸åŒçš„ä½œç”¨ï¼Œä¸»è¦åŒ…æ‹¬ï¼š

1. **è¾“å…¥å±‚ï¼ˆInput Layerï¼‰**
   1. å›¾åƒé€šå¸¸è¡¨ç¤ºä¸º **å¤šç»´çŸ©é˜µï¼ˆTensorï¼‰**
2. <u>**å·ç§¯å±‚ï¼ˆConvolutional Layerï¼‰**</u>
3. <u>**æ¿€æ´»å‡½æ•°å±‚ï¼ˆActivation Layerï¼Œä¾‹å¦‚ ReLUï¼‰**</u>
4. <u>**æ± åŒ–å±‚ï¼ˆPooling Layerï¼Œä¾‹å¦‚ Max Poolingï¼‰**</u>
5. **å½’ä¸€åŒ–å±‚ï¼ˆNormalization Layerï¼Œä¾‹å¦‚ Batch Normalizationï¼‰**
6. <u>**å…¨è¿æ¥å±‚ï¼ˆFully Connected Layerï¼‰**</u>
7. **Softmax å±‚ï¼ˆç”¨äºåˆ†ç±»ï¼‰**
   1. Softmax å±‚æ˜¯**ç¥ç»ç½‘ç»œä¸­çš„è¾“å‡ºå±‚**ï¼Œ**é€‚ç”¨äºå¤šåˆ†ç±»ä»»åŠ¡ï¼ˆmutually exclusive classesï¼‰**ã€‚
   2. ğŸš« **ä¸é€‚ç”¨äºäºŒåˆ†ç±»ä»»åŠ¡**ï¼ŒäºŒåˆ†ç±»é€šå¸¸ç”¨ `sigmoid` ä»£æ›¿ `softmax`
   3. **å®ƒçš„ä½œç”¨æ˜¯ï¼š**
      1. **Softmax æŠŠ logits è½¬æ¢æˆæ¦‚ç‡**ï¼Œé€‚ç”¨äº **å¤šåˆ†ç±»ä»»åŠ¡**ã€‚
      2. **æ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡åŠ èµ·æ¥ç­‰äº 1**ï¼Œæ–¹ä¾¿å†³ç­–ã€‚The probabilities for each class add up to 1


### **ğŸ“Œ å…³é”®çš„å±‚**

CNN ç”±å¤šä¸ªå±‚ç»„æˆï¼Œæ¯ä¸€å±‚è´Ÿè´£ä¸åŒçš„ä»»åŠ¡ï¼Œå¦‚**ç‰¹å¾æå–ã€é™ç»´ã€åˆ†ç±»ç­‰**ã€‚

### **ğŸ”¹ 1. å·ç§¯å±‚ï¼ˆConvolutional Layerï¼‰**

**ä½œç”¨**ï¼š

- <u>ä½¿ç”¨**å·ç§¯æ ¸ï¼ˆfiltersï¼‰**æå–ç‰¹å¾ï¼Œå¦‚è¾¹ç¼˜ã€è§’ç‚¹ã€çº¹ç†ã€‚</u>
- æ¯ä¸ªå·ç§¯æ ¸è´Ÿè´£è¯†åˆ«ä¸åŒçš„æ¨¡å¼ï¼Œæ¯”å¦‚çŒ«çš„è€³æœµã€çœ¼ç›ç­‰ã€‚

**ä»£ç ç¤ºä¾‹**

```python
import torch.nn as nn

conv_layer = nn.Conv2d(in_channels=3, out_channels=16, kernel_size=3, stride=1, padding=1)
```

------



### **ğŸ”¹ 2. æ¿€æ´»å±‚ï¼ˆActivation Layerï¼‰**

**ä½œç”¨**ï¼š

- å¼•å…¥éçº¿æ€§ï¼Œæé«˜æ¨¡å‹è¡¨è¾¾èƒ½åŠ›ã€‚
- è§£å†³çº¿æ€§å˜æ¢çš„å±€é™æ€§ï¼Œå¸¸ç”¨å‡½æ•°ï¼š
  - **ReLU**ï¼ˆå¸¸è§ï¼‰: è§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼ˆè®©è´Ÿæ•°å˜ä¸º 0ï¼Œä¿ç•™æ­£æ•°ã€‚ï¼‰
    - **ReLUï¼ˆRectified Linear Unitï¼‰**
  - **Sigmoid**ï¼ˆå°‘ç”¨ï¼‰: é€‚åˆäºŒåˆ†ç±»
  - **Tanh**ï¼ˆå°‘ç”¨ï¼‰: é€‚åˆå°æ•°æ®é›†

**ä»£ç ç¤ºä¾‹**ï¼š

**ä½œç”¨**ï¼š

- è§£å†³**æ¢¯åº¦æ¶ˆå¤±é—®é¢˜**ï¼ˆSigmoid å’Œ Tanh ä¼šå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ï¼‰ã€‚
- **åŠ é€Ÿæ”¶æ•›**ï¼Œå‡å°‘è®¡ç®—é‡ã€‚

```python
activation = nn.ReLU()
activated_output = activation(output)
```

------



### **ğŸ”¹ 3. æ± åŒ–å±‚ï¼ˆPooling Layerï¼‰**

**ä½œç”¨**ï¼š

- **é™ä½æ•°æ®ç»´åº¦**ï¼Œå‡å°‘è®¡ç®—é‡ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚
- è¿‡æ»¤ä¸é‡è¦çš„ä¿¡æ¯ï¼Œå¢å¼ºç‰¹å¾çš„é²æ£’æ€§ã€‚

**å¸¸è§æ± åŒ–æ–¹å¼**ï¼š

- **æœ€å¤§æ± åŒ–ï¼ˆMax-Poolingï¼‰**: é€‰å–å±€éƒ¨æœ€å¤§å€¼ï¼Œä¿ç•™å…³é”®ç‰¹å¾ã€‚
- **å‡å€¼æ± åŒ–ï¼ˆAverage-Poolingï¼‰**: è®¡ç®—åŒºåŸŸå‡å€¼ï¼Œå¹³æ»‘ç‰¹å¾ã€‚

**ä»£ç ç¤ºä¾‹**

```python
max_pool = nn.MaxPool2d(kernel_size=2, stride=2)
avg_pool = nn.AvgPool2d(kernel_size=2, stride=2)
```

------



### **ğŸ”¹ 4. å…¨è¿æ¥å±‚ï¼ˆFully Connected Layer, FCï¼‰**

**ä½œç”¨**ï¼š

- é€šè¿‡ç¥ç»å…ƒè¿›è¡Œæœ€ç»ˆåˆ†ç±»ã€‚
- å°†å·ç§¯å±‚æå–çš„ç‰¹å¾è½¬æ¢æˆå…·ä½“ç±»åˆ«ã€‚
- **è¾“å…¥æ˜¯æ‹‰å¹³ï¼ˆFlattenï¼‰çš„ç‰¹å¾**ï¼Œè½¬æ¢æˆä¸€ç»´å‘é‡ã€‚

**ä»£ç ç¤ºä¾‹**

```python
fc = nn.Linear(in_features=128, out_features=10)  # 128 ä¸ªè¾“å…¥ç‰¹å¾ï¼Œè¾“å‡º 10 ç±»
```

------

### CNN å…¸å‹ç»“æ„ç¤ºä¾‹

```python
class SimpleCNN(nn.Module):
    def __init__(self):
        super(SimpleCNN, self).__init__()
        self.conv1 = nn.Conv2d(1, 16, 3, padding=1)
        self.relu = nn.ReLU()
        self.pool = nn.MaxPool2d(2, 2)
        self.conv2 = nn.Conv2d(16, 32, 3, padding=1)
        self.fc1 = nn.Linear(32*7*7, 128)
        self.fc2 = nn.Linear(128, 10)  # 10 ä¸ªç±»åˆ«
        self.softmax = nn.Softmax(dim=1)

    def forward(self, x):
        x = self.pool(self.relu(self.conv1(x)))
        x = self.pool(self.relu(self.conv2(x)))
        x = x.view(x.size(0), -1)
        x = self.relu(self.fc1(x))
        x = self.softmax(self.fc2(x))
        return x

```

## **Conv æ€»ç»“**

| **å±‚**                    | **ä½œç”¨**                 |
| ------------------------- | ------------------------ |
| **è¾“å…¥å±‚**                | è¯»å–å›¾ç‰‡æ•°æ®             |
| **å·ç§¯å±‚**                | æå–ç‰¹å¾ï¼ˆè¾¹ç¼˜ã€çº¹ç†ï¼‰   |
| **æ¿€æ´»å‡½æ•°ï¼ˆReLUï¼‰**      | è®©æ¨¡å‹å­¦ä¹ éçº¿æ€§ç‰¹å¾     |
| **æ± åŒ–å±‚ï¼ˆMax Poolingï¼‰** | é™ä½æ•°æ®ç»´åº¦ï¼Œå‡å°‘è®¡ç®—é‡ |
| **å½’ä¸€åŒ–å±‚ï¼ˆBatchNormï¼‰** | åŠ é€Ÿæ”¶æ•›ï¼Œæé«˜ç¨³å®šæ€§     |
| **å…¨è¿æ¥å±‚**              | è´Ÿè´£åˆ†ç±»                 |
| **Softmax**               | è¾“å‡ºåˆ†ç±»æ¦‚ç‡             |




